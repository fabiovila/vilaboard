!function(){var t=function(e){return document.getElementById(e)},n=this.__canvas=new fabric.Canvas("c",{isDrawingMode:!0,isFullScreen:!1,selectedColor:"#000000",selectedStroke:"2px",undo:[],redo:[],teachingmode:!0,backgroundImage:null});t("teach");n.setDimensions({width:window.innerWidth,height:window.innerHeight-75}),document.addEventListener("keydown",function(e){const t=n.getActiveObject(),o=e.key;if("Delete"===o&&n.remove(t),e.ctrlKey&&"z"===o){const e=n.undo.pop();void 0!==e&&e.undo()}}),window.addEventListener("resize",function(){console.log(window.innerWidth,window.innerHeight),n.setDimensions({width:window.innerWidth,height:window.innerHeight-100})}),fabric.Object.prototype.transparentCorners=!1;t("drawing-mode"),t("drawing-shadow-width");function o(e){n.selectedColor=e,n.freeDrawingBrush.color=n.selectedColor;const t=n.getActiveObject();null!=t&&(t instanceof fabric.Textbox?t.set("fill",e):t.set("stroke",e),n.renderAll())}if(t("addtextbt").onmouseup=function(){n.isDrawingMode=!1;var e=new fabric.Textbox(t("addtext").value,{fill:n.selectedColor,fontFamily:"sans-serif",statefullCache:!0});n.teachingmode&&e.setControlsVisibility({bl:!1,tl:!1,tr:!1,ml:!1,mb:!1,mt:!1,mtr:!1}),n.add(e)},t("select").onclick=function(){n.isDrawingMode=!1},t("draw").onclick=function(){n.isDrawingMode=!0},t("new").onclick=(()=>{n.clear()}),t("del").onclick=(()=>{const e=n.getActiveObject();n.remove(e)}),t("white").onclick=function(){o(this.getAttribute("value"))},t("black").onclick=function(){o(this.getAttribute("value"))},t("color1").onclick=function(){o(this.getAttribute("value"))},t("color2").onclick=function(){o(this.getAttribute("value"))},t("color3").onclick=function(){o(this.getAttribute("value"))},t("color4").onclick=function(){o(this.getAttribute("value"))},t("stroke1").onclick=function(){n.freeDrawingBrush.width=parseInt(this.getAttribute("value"),10)||1},t("stroke2").onclick=function(){n.freeDrawingBrush.width=parseInt(this.getAttribute("value"),10)||1},t("stroke3").onclick=function(){n.freeDrawingBrush.width=parseInt(this.getAttribute("value"),10)||1},t("stroke4").onclick=function(){n.freeDrawingBrush.width=parseInt(this.getAttribute("value"),10)||1},t("t1").onclick=(e=>{const t=e.target.src;document.body.style.backgroundImage=`url('${t}')`}),t("t2").onclick=(e=>{const t=e.target.src;document.body.style.backgroundImage=`url('${t}')`}),t("t3").onclick=(e=>{const t=e.target.src;document.body.style.backgroundImage=`url('${t}')`}),n.on("object:modified",()=>{n.undo.push({undo:()=>n.remove(e.target),redo:()=>n.add(e.target)})}),n.on("object:added",e=>{n.undo.push({undo:()=>{e.target.vilaundo=!0,n.remove(e.target)},redo:()=>{n.add(e.target)}})}),n.on("object:removed",e=>{n.undo.push({undo:()=>n.add(e.target),redo:()=>n.remove(e.target)})}),n.freeDrawingBrush=new fabric.PencilBrush(n,{statefullCache:!0}),n.freeDrawingBrush){var i=n.freeDrawingBrush;i.color="#000000",i.getPatternSrc&&(i.source=i.getPatternSrc.call(i)),i.width=2,i.shadow=new fabric.Shadow({blur:5,offsetX:3,offsetY:3,affectStroke:!0,color:"#00000022"})}}(),window.addEventListener("load",function(){var e=this.__canvas||this.canvas,t=this.__canvases||this.canvases;if(e&&e.calcOffset&&e.calcOffset(),t&&t.length)for(var n=0,o=t.length;n<o;n++)t[n].calcOffset()});